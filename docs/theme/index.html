<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>定制主题</title>
    <link rel="stylesheet" href="/kpc/theme-kpc.css" />
</head>
<body>
    
    
    <div id="page"><div class="k-app"><div class="main-wrapper document-page fixed-aside"><div class="header-wrapper"><header><a class="logo" href="/">KPC</a><div class="right"><nav><a class="" href="/kpc/docs/design/language/">设计语言</a><a class="active" href="/kpc/docs/getting-started/">教程</a><a class="" href="/kpc/docs/blogs/design/">Blog</a><div class="border"></div></nav><span class="label">切换主题：</span><div class="k-select k-small k-has-value" style="width:100px;" tabindex="0"><div class="k-wrapper" tabindex="-1" _hasSaved><input type="hidden" value="kpc" /><span class="k-value c-ellipsis">default</span><span class="k-suffix"><i class="k-arrow ion-arrow-down-b"></i></span></div><!--MoveWrapper--></div></div></header></div><div class="content-wrapper"><aside><div class="aside-wrapper"><div class="catalog-section"><ul><li><a href="/kpc/docs/getting-started/">快速开始</a></li><li class="active"><a href="/kpc/docs/theme/">定制主题</a></li><li><a href="/kpc/docs/vue/">Vue中使用</a></li><li><a href="/kpc/docs/i18n/">国际化</a></li><li><a href="/kpc/docs/icon/">字体icon</a></li><li><a href="/kpc/docs/changelog/"><div class="k-badge" style="">更新日志</div></a></li></ul></div><div class="catalog-section"><h5>组件</h5><ul><li><a href="/kpc/components/app/">App<span>应用管理</span></a></li><li><a href="/kpc/components/badge/">Badge<span>徽标</span></a></li><li><a href="/kpc/components/breadcrumb/">Breadcrumb<span>面包屑</span></a></li><li><a href="/kpc/components/button/">Button<span>按钮</span></a></li><li><a href="/kpc/components/cascader/">Cascader<span>级联选择</span></a></li><li><a href="/kpc/components/checkbox/">Checkbox<span>复选框</span></a></li><li><a href="/kpc/components/collapse/">Collapse<span>折叠面板</span></a></li><li><a href="/kpc/components/datepicker/">Datepicker<span>日期选择</span></a></li><li><a href="/kpc/components/dialog/">Dialog<span>弹窗</span></a></li><li><a href="/kpc/components/dropdown/">Dropdown<span>下拉菜单</span></a></li><li><a href="/kpc/components/editable/">Editable<span>可编辑文本</span></a></li><li><a href="/kpc/components/form/">Form<span>表单</span></a></li><li><a href="/kpc/components/grid/">Grid<span>栅格</span></a></li><li><a href="/kpc/components/input/">Input<span>输入框</span></a></li><li><a href="/kpc/components/message/">Message<span>全局提示</span></a></li><li><a href="/kpc/components/pagination/">Pagination<span>分页</span></a></li><li><a href="/kpc/components/progress/">Progress<span>进度条</span></a></li><li><a href="/kpc/components/radio/">Radio<span>单选框</span></a></li><li><a href="/kpc/components/select/">Select<span>选择框</span></a></li><li><a href="/kpc/components/slider/">Slider<span>滑块</span></a></li><li><a href="/kpc/components/spin/">Spin<span>加载中</span></a></li><li><a href="/kpc/components/spinner/">Spinner<span>数字输入框</span></a></li><li><a href="/kpc/components/steps/">Steps<span>步骤条</span></a></li><li><a href="/kpc/components/switch/">Switch<span>开关</span></a></li><li><a href="/kpc/components/table/">Table<span>表格</span></a></li><li><a href="/kpc/components/tabs/">Tabs<span>选项卡</span></a></li><li><a href="/kpc/components/tag/">Tag<span>标签</span></a></li><li><a href="/kpc/components/tip/">Tip<span>警告提示</span></a></li><li><a href="/kpc/components/tooltip/">Tooltip<span>提示弹层</span></a></li><li><a href="/kpc/components/transfer/">Transfer<span>穿梭框</span></a></li><li><a href="/kpc/components/upload/">Upload<span>上传</span></a></li></ul></div><div class="aside-border transition"></div></div></aside><article><div class="article-head"><div class="title">定制主题</div><div class="edit-link">
                    如果你发现文档有问题，请帮忙在
                    <a target="_blank" href="https://github.com/ksc-fe/kpc/blob/master/docs/theme.md">github</a>
                    上修正该文档
                </div></div><div class="contents"><div class="api"><div><p>在快速开始章节我们提到过“多文件半构建版”可以支持主题定制。因为这个版本样式文件使用了源码<code>stylus</code>，所以我们可以引入主题文件在构建时生成自定义主题的css样式。</p>
<p>得益于<code>stylus-loader</code>的<code>import</code>配置，我们可以指定一个主题文件，它会在编译每一个stylus文件时引入它。</p>
<h1 id='header-%E9%85%8D%E7%BD%AEwebpack.config.js'>配置<code>webpack.config.js</code></h1><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-comment">// 其他配置参见快速开始章节，这里略去</span>
...
{
    <span class="hljs-attr">loader</span>: <span class="hljs-string">'stylus-loader'</span>,
    <span class="hljs-attr">options</span>: {
        <span class="hljs-string">'incluce css'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// 引入自定义主题文件mytheme/index.styl</span>
        <span class="hljs-keyword">import</span>: path.resolve(__dirname, <span class="hljs-string">'styles/mytheme/index.styl'</span>)
    }
}
</code></pre>
<blockquote>
<p>kpc内置了一个<code>ksyun</code>的主题，我们只需要将<code>import</code>指向它即可<code>import: path.resolve(__dirname, &#39;node_modules/kpc/styles/themes/ksyun/index.styl&#39;)</code></p>
</blockquote>
<h1 id='header-%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98'>定义主题</h1><h2 id='header-%E4%BF%AE%E6%94%B9%E5%8F%98%E9%87%8F'>修改变量</h2><p>kpc几乎将所有的可能变更的属性都提取成了变量，组件对应的变量命名规则为：使用小写字母<code>${组件名}-{类型}-{属性名}</code>的方式命名。例如：<code>$btn-primary-color := #fff</code> <code>$dialog-width := unit(670 / 14, rem)</code>等。</p>
<p>通过修改<code>import</code>进来的主题文件中的变量，如上面<code>import</code>的文件<code>styles/themes/index.styl</code>，就可以自定义自己的主题。</p>
<p>以上面提到的<code>styles/mytheme/index.styl</code>文件为例:</p>
<pre><code class="hljs styl"><span class="hljs-comment">// 修改主色调</span>
<span class="hljs-variable">$primary</span>-<span class="hljs-attribute">color</span> := <span class="hljs-number">#289af4</span> 

<span class="hljs-comment">/**
 * btn
 */</span>
<span class="hljs-comment">// 修改button组件的padding值</span>
<span class="hljs-variable">$btn</span>-<span class="hljs-attribute">padding</span> := <span class="hljs-number">0</span> <span class="hljs-number">30px</span>
</code></pre>
<blockquote>
<p>赋值符号<code>:=</code>是stylus的语法，意思是当变量被赋值过时，则忽略本次赋值。所以我们可以通过<code>import</code>提前加载一个变量定义文件，来让kpc中的默认定义失效</p>
</blockquote>
<h2 id='header-%E6%B7%BB%E5%8A%A0%E6%96%B0%E6%A0%B7%E5%BC%8F'>添加新样式</h2><p>并非所有的样式修改都可以通过修改变量来实现，因为变量只能重新定义已有的样式的值，但不能新增样式。例如：<code>Button</code>组件的<code>type</code>只内置了<code>default | primary | warning | danger | none</code>几种样式，如果我们想向主题中添加一种<code>dashed</code>虚边框的按钮，则不能通过修改变量得到。也许你会想，我们可以在全局样式中，将<code>dashed</code>按钮的样式定义好，然后在需要该样式的地方添加相应类名即可。是的，这样的确能实现，但弊端是不能按需加载，因为在全局样式中，即使我不使用<code>Button</code>组件，该样式也会加载。而如果将该样式文件单独定义，然后在用到<code>Button</code>的地方，再手动加载它，又显得麻烦。</p>
<p>其实kpc加载每一个组件的样式时，会检测是否存在对应的主题文件，如果存在就会默认加载它。通过该机制，我们可以很方便地在主题中添加样式。</p>
<p>以上文提到的<code>dashed</code>按钮为例：</p>
<h3 id='header-%E6%8C%87%E5%AE%9A%24theme-dir'>指定<code>$theme-dir</code></h3><p>首先我们需要在主题文件<code>styles/mytheme/index.styl</code>中指定<code>$theme-dir</code>变量，来告诉kpc主题文件的位置。遗憾的是，stylus中并没有类似<code>__dirname</code>的全局变量，不过我们可以通过stylus的<code>use</code>方法来实现。</p>
<ol>
<li>在<code>styles/mytheme/</code>下新建js文件<code>dirname.js</code>，定义<code>__dirname</code>方法</li>
</ol>
<pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">style</span>) </span>{
        style.define(<span class="hljs-string">'__dirname'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> path.dirname(style.nodes.filename);
        });
    };
};
</code></pre>
<ol start="2">
<li>在主题文件<code>styles/mytheme/index.styl</code>中<code>use</code>上述<code>dirname.js</code>，并定义<code>$theme-dir</code></li>
</ol>
<pre><code class="hljs styl"><span class="hljs-function"><span class="hljs-title">use</span><span class="hljs-params">(<span class="hljs-string">'./dirname.js'</span>)</span></span>
<span class="hljs-variable">$theme</span>-dir := __dirname()

<span class="hljs-comment">// 以下为变量定义</span>
...
</code></pre>
<p>此时<code>$theme-dir</code>指向<code>styles/mytheme</code>目录，kpc会在该目录下检测主题文件。</p>
<ol start="3">
<li>在<code>styles/mytheme/</code>下新建<code>button.styl</code>文件（文件名必须与组件名对应），添加<code>k-dashed</code>
样式定义</li>
</ol>
<pre><code class="hljs styl"><span class="hljs-selector-class">.k-dashed</span>
    <span class="hljs-attribute">border</span> <span class="hljs-number">1px</span> dashed <span class="hljs-number">#eee</span> 
</code></pre>
<p>此时，当我们加载<code>Button</code>组件时，上述样式也会加载进来。真正做到按需加载，并且无需额外插件支持。</p>
<h1 id='header-%E5%8F%91%E5%B8%83%E4%B8%BB%E9%A2%98'>发布主题</h1><p>我们可以将定义好的主题文件，发布到npm供他人使用。使用者只需要改变<code>stylus-loader</code>中的<code>import</code>配置，指向你发布的主题文件<code>index.styl</code>即可。</p>
<p>热烈欢迎大家积极发布自己的主题来让kpc丰富多彩起来 <i class="k-icon ion-android-happy"></i></p>
</div></div></div></article></div></div></div></div>
    <script src="/kpc/static/client.js" type="text/javascript"></script>
</body>
</html>